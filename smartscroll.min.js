!function(S){var b,y="mousewheel DOMMouseScroll wheel MozMousePixelScroll";"undefined"!=typeof Lethargy&&null!==Lethargy&&(b=new Lethargy);var k=function(){return Math.max(window.pageYOffset,window.document.body.scrollTop,window.document.documentElement.scrollTop)};S.smartscroll=function(e){var s=S.extend({},S.smartscroll.defaults,e);if(s.sectionSelector||(s.sectionSelector="."+s.sectionClass),("undefined"==typeof EventEmitter||null===EventEmitter||s.eventEmitter&&s.eventEmitter.constructor!==EventEmitter)&&(s.eventEmitter=null),s.bindSwipe)var a=null,l=null,t=function(e){var t=e.originalEvent||e;a=t.touches[0].clientX,l=t.touches[0].clientY},n=function(e){var t=e.originalEvent||e;if(a&&l){var n=t.touches[0].clientX,i=t.touches[0].clientY,o=a-n,r=l-i;Math.abs(o)>Math.abs(r)?0<o?s.eventEmitter.emitEvent("swipeLeft"):s.eventEmitter.emitEvent("swipeRight"):0<r?s.eventEmitter.emitEvent("swipeUp"):s.eventEmitter.emitEvent("swipeDown"),l=a=null}};var c,d,h=!1,u=[],i=!1,o=!1,r=window.location.hash,w=S(s.sectionWrapperSelector+":first"),v=function(){var n=[];c=Math.round(w.position().top+parseInt(w.css("paddingTop"),10)+parseInt(w.css("borderTopWidth"),10)+parseInt(w.css("marginTop"),10)),d=Math.round(c+w.height(),10),n.push(c),S(s.sectionSelector).each(function(e,t){n.push(Math.round(c+S(t).position().top+S(t).outerHeight()))}),u=n},p=function(e){for(var t=0;t<u.length;t+=1)if(e<=u[t])return t;return u.length},m=function(){var e;if(k()+S(window).height()/2<c)e=s.headerHash;else{var t=p(k()+S(window).height()/2);t!==undefined&&(e=S(s.sectionSelector+":nth-of-type("+t+")").data("hash"))}void 0!==e&&window.location.hash==="#"+e||(void 0===e&&(e=s.headerHash),s.keepHistory?window.location.hash=e:window.location.replace(window.location.href.split("#")[0]+"#"+e))},f=function(e,t){h||(h=!0,S("body,html").stop(!0,!0).animate({scrollTop:e},t,function(){if(h=!1,s.eventEmitter){var e=k(),t=p(e+S(window).height()/2);s.eventEmitter.emitEvent("scrollEnd",[t])}}))};this.scroll=function(e){if(u){var t,n=k();if(s.eventEmitter){t=p(n+S(window).height()/2);var i=e?t+1:t-1;s.eventEmitter.emitEvent("scrollStart",[i])}for(var o=0;o<u.length;o+=1)if(n<u[o])return f(e?u[o]:u[o-1]-S(window).height(),s.animationSpeed),s.eventEmitter&&s.eventEmitter.emitEvent("scrollEnd",[t]),!1}return undefined};var E=function(){S(window).bind(y,function(e){var t=function(e){var t;if(b&&(t=b.check(e)),!h)if(b){if(1===t)return"up";if(-1===t)return"down"}else{if(0<e.originalEvent.wheelDelta||e.originalEvent.detail<0)return"up";if(e.originalEvent.wheelDelta<0||0<e.originalEvent.detail)return"down"}return!1}(e);s.dynamicHeight&&v();var n=k(),i=n+S(window).height();if(c<i&&n<=d){var o=p(n),r=p(n+S(window).height()/2);o===p(i)&&s.innerSectionScroll||(e.preventDefault(),e.stopPropagation(),t&&("up"===t?(s.toptotop?f(u[r-2]+1,s.animationSpeed):f(u[r-1]-S(window).height(),s.animationSpeed),s.eventEmitter&&s.eventEmitter.emitEvent("scrollStart",[r-1])):"down"===t&&u[r]&&(f(u[r]+1,s.animationSpeed),s.eventEmitter&&s.eventEmitter.emitEvent("scrollStart",[r+1]))))}})};if(w.css({position:"relative"}),setTimeout(function(){if(v(),s.autoHash&&(null===s.eventEmitter||s.hashContinuousUpdate?S(window).bind("scroll",m):s.eventEmitter.addListener("scrollEnd",m)),s.initialScroll&&0<r.length){var e=S('[data-hash="'+r.substr(1)+'"]');0<e.length&&f(e[0].offsetTop+c,0)}},50),S(window).bind("resize",v),null!==s.breakpoint&&s.breakpoint===parseInt(s.breakpoint,10)&&0<s.breakpoint&&(i=!0),"vp"===s.mode)if(s.ie8){var g=function(){S(s.sectionSelector).css({height:S(window).height()})};g(),S(window).bind("resize",g)}else S(s.sectionSelector).css({height:"100vh"});if(s.sectionScroll&&(i&&S(window).bind("resize",function(){if(S(window).width()<s.breakpoint){if(!o)return S(window).unbind(y),!(o=!0)}else o&&(E(),o=!1);return undefined}),E()),s.bindSwipe&&(S(window).on("touchstart",t),S(window).on("touchmove",n)),s.bindKeyboard){S(window).on("keydown",function(e){var t=e.originalEvent||e;s.dynamicHeight&&v();var n,i,o=k(),r=o+S(window).height();if(n=k(),i=n+S(window).height(),c<i&&n<=d){var a=p(o),l=p(o+S(window).height()/2);if(a!==p(r)||!s.innerSectionScroll)switch(t.which){case 38:t.preventDefault(),t.stopPropagation(),s.toptotop?f(u[l-2]+1,s.animationSpeed):f(u[l-1]-S(window).height(),s.animationSpeed),s.eventEmitter&&s.eventEmitter.emitEvent("scrollStart",[l-1]);break;case 40:t.preventDefault(),t.stopPropagation(),u[l]&&(f(u[l]+1,s.animationSpeed),s.eventEmitter&&s.eventEmitter.emitEvent("scrollStart",[l+1]))}}})}return this},S.smartscroll.defaults={animationSpeed:700,autoHash:!0,breakpoint:null,initialScroll:!0,headerHash:"header",keepHistory:!1,mode:"vp",sectionClass:"section",sectionSelector:null,sectionScroll:!0,sectionWrapperSelector:".section-wrapper",eventEmitter:null,dynamicHeight:!1,ie8:!1,hashContinuousUpdate:!0,innerSectionScroll:!0,toptotop:!1,bindSwipe:!0,bindKeyboard:!0}}(jQuery);